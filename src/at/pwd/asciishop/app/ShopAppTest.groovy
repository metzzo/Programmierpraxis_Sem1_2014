package at.pwd.asciishop.app

import at.pwd.asciishop.helper.IOHelper

/**
 * Created by Robert on 06.11.2014.
 */
class ShopAppTest extends GroovyTestCase {
    def app, input, output
    def data = [
        [
            'input': 'read 3\naaa\naaa\naaa\nfill 1 1 b',
            'output': 'bbb\nbbb\nbbb\n3 3\n'
        ],
        [
            'input': 'read 27\n' +
                    '============,.V+.;============\n' +
                    '===========;.X##..;===========\n' +
                    '===========..####..===========\n' +
                    '==========,.##M###.:==========\n' +
                    '=========;.R##WW##=.;=========\n' +
                    '=========..##MWMW##,.=========\n' +
                    '========:.I##WWMWW#W.,========\n' +
                    '=======;.:##WWWWWW##I.;=======\n' +
                    '=======:.W########M##..=======\n' +
                    '=======.:############V.;======\n' +
                    '=======.####...,.,M###,.======\n' +
                    '======,.###:..+++;,B..#.;=====\n' +
                    '=====;.#;.#i+YXVVY:#V.#..:====\n' +
                    '====:..#..##.RYYIt##...#=.,===\n' +
                    '==;..+#;...#######W....##W..:=\n' +
                    ':..t###......iVV=....,.+#iM#..\n' +
                    '.B#i,#..,,..........,,..#,..#I\n' +
                    'V#...#..,,,,,.,,,,:,,,..R#..V#\n' +
                    ';#+.i#..,,,,,,,,,.,,,,,.iX.X#,\n' +
                    '.i#=MV..,,,,.,,,,,,.,,,..###..\n' +
                    ',.t##..,,,,,,,,,,,,,,:,..V##.;\n' +
                    '..M#M..,,,,.,.,,,,,,,:,,.=##..\n' +
                    'i###M..,...........,,:,,..###.\n' +
                    '.####........=II;.....,,.;##R.\n' +
                    ',...#....X####MW###B.....Wi..:\n' +
                    '==;,##,###;........##i...#;,==\n' +
                    '===,.IVi..,;======:..B#B#t.;==\n' +
                    'fill 2 28 m',
            'output': 'OPERATION FAILED\n'
        ],
        [
            'input': '27\n' +
                    '============,.V+.;============\n' +
                    '===========;.X##..;===========\n' +
                    '===========..####..===========\n' +
                    '==========,.##M###.:==========\n' +
                    '=========;.R##WW##=.;=========\n' +
                    '=========..##MWMW##,.=========\n' +
                    '========:.I##WWMWW#W.,========\n' +
                    '=======;.:##WWWWWW##I.;=======\n' +
                    '=======:.W########M##..=======\n' +
                    '=======.:############V.;======\n' +
                    '=======.####...,.,M###,.======\n' +
                    '======,.###:..+++;,B..#.;=====\n' +
                    '=====;.#;.#i+YXVVY:#V.#..:====\n' +
                    '====:..#..##.RYYIt##...#=.,===\n' +
                    '==;..+#;...#######W....##W..:=\n' +
                    ':..t###......iVV=....,.+#iM#..\n' +
                    '.B#i,#..,,..........,,..#,..#I\n' +
                    'V#...#..,,,,,.,,,,:,,,..R#..V#\n' +
                    ';#+.i#..,,,,,,,,,.,,,,,.iX.X#,\n' +
                    '.i#=MV..,,,,.,,,,,,.,,,..###..\n' +
                    ',.t##..,,,,,,,,,,,,,,:,..V##.;\n' +
                    '..M#M..,,,,.,.,,,,,,,:,,.=##..\n' +
                    'i###M..,...........,,:,,..###.\n' +
                    '.####........=II;.....,,.;##R.\n' +
                    ',...#....X####MW###B.....Wi..:\n' +
                    '==;,##,###;........##i...#;,==\n' +
                    '===,.IVi..,;======:..B#B#t.;==\n' +
                    'fill 1 2 m',
            'output': 'INPUT MISMATCH\n'
        ],
        [
            'input': 'read 27\n' +
                    '============,.V+.;============\n' +
                    '===========;.X##..;===========\n' +
                    '===========..####..===========\n' +
                    '==========,.##M###.:==========\n' +
                    '=========;.R##WW##=.;=========\n' +
                    '=========..##MWMW##,.=========\n' +
                    '========:.I##WWMWW#W.,========\n' +
                    '=======;.:##WWWWWW##I.;=======\n' +
                    '=======:.W########M##..=======\n' +
                    '=======.:############V.;======\n' +
                    '=======.####...,.,M###,.======\n' +
                    '======,.###:..+++;,B..#.;=====\n' +
                    '=====;.#;.#i+YXVVY:#V.#..:====\n' +
                    '====:..#..##.RYYIt##...#=.,===\n' +
                    '==;..+#;...#######W....##W..:=\n' +
                    ':..t###......iVV=....,.+#iM#..\n' +
                    '.B#i,#..,,..........,,..#,..#I\n' +
                    'V#...#..,,,,,.,,,,:,,,..R#..V#\n' +
                    ';#+.i#..,,,,,,,,,.,,,,,.iX.X#,\n' +
                    '.i#=MV..,,,,.,,,,,,.,,,..###..\n' +
                    ',.t##..,,,,,,,,,,,,,,:,..V##.;\n' +
                    '..M#M..,,,,.,.,,,,,,,:,,.=##..\n' +
                    'i###M..,...........,,:,,..###.\n' +
                    '.####........=II;.....,,.;##R.\n' +
                    ',...#....X####MW###B.....Wi..:\n' +
                    '==;,##,###;........##i...#;,==\n' +
                    '===,.IVi..,;======:..B#B#t.;==\n' +
                    'fill 0 0 $\n' +
                    'fill 20 1 #',
            'output': '$$$$$$$$$$$$,.V+.;############\n' +
                    '$$$$$$$$$$$;.X##..;###########\n' +
                    '$$$$$$$$$$$..####..###########\n' +
                    '$$$$$$$$$$,.##M###.:##########\n' +
                    '$$$$$$$$$;.R##WW##=.;#########\n' +
                    '$$$$$$$$$..##MWMW##,.#########\n' +
                    '$$$$$$$$:.I##WWMWW#W.,########\n' +
                    '$$$$$$$;.:##WWWWWW##I.;#######\n' +
                    '$$$$$$$:.W########M##..#######\n' +
                    '$$$$$$$.:############V.;######\n' +
                    '$$$$$$$.####...,.,M###,.######\n' +
                    '$$$$$$,.###:..+++;,B..#.;#####\n' +
                    '$$$$$;.#;.#i+YXVVY:#V.#..:####\n' +
                    '$$$$:..#..##.RYYIt##...#=.,###\n' +
                    '$$;..+#;...#######W....##W..:#\n' +
                    ':..t###......iVV=....,.+#iM#..\n' +
                    '.B#i,#..,,..........,,..#,..#I\n' +
                    'V#...#..,,,,,.,,,,:,,,..R#..V#\n' +
                    ';#+.i#..,,,,,,,,,.,,,,,.iX.X#,\n' +
                    '.i#=MV..,,,,.,,,,,,.,,,..###..\n' +
                    ',.t##..,,,,,,,,,,,,,,:,..V##.;\n' +
                    '..M#M..,,,,.,.,,,,,,,:,,.=##..\n' +
                    'i###M..,...........,,:,,..###.\n' +
                    '.####........=II;.....,,.;##R.\n' +
                    ',...#....X####MW###B.....Wi..:\n' +
                    '==;,##,###;........##i...#;,==\n' +
                    '===,.IVi..,;======:..B#B#t.;==\n' +
                    '30 27\n'
        ],
        [
            'input': 'read 27\n' +
                    '============,.V+.;============\n' +
                    '===========;.X##..;===========\n' +
                    '===========..####..===========\n' +
                    '==========,.##M###.:==========\n' +
                    '=========;.R##WW##=.;=========\n' +
                    '=========..##MWMW##,.=========\n' +
                    '========:.I##WWMWW#W.,========\n' +
                    '=======;.:##WWWWWW##I.;=======\n' +
                    '=======:.W########M##..=======\n' +
                    '=======.:############V.;======\n' +
                    '=======.####...,.,M###,.======\n' +
                    '======,.###:..+++;,B..#.;=====\n' +
                    '=====;.#;.#i+YXVVY:#V.#..:====\n' +
                    '====:..#..##.RYYIt##...#=.,===\n' +
                    '==;..+#;...#######W....##W..:=\n' +
                    ':..t###......iVV=....,.+#iM#..\n' +
                    '.B#i,#..,,..........,,..#,..#I\n' +
                    'V#...#..,,,,,.,,,,:,,,..R#..V#\n' +
                    ';#+.i#..,,,,,,,,,.,,,,,.iX.X#,\n' +
                    '.i#=MV..,,,,.,,,,,,.,,,..###..\n' +
                    ',.t##..,,,,,,,,,,,,,,:,..V##.;\n' +
                    '..M#M..,,,,.,.,,,,,,,:,,.=##..\n' +
                    'i###M..,...........,,:,,..###.\n' +
                    '.####........=II;.....,,.;##R.\n' +
                    ',...#....X####MW###B.....Wi..:\n' +
                    '==;,##,###;........##i...#;,==\n' +
                    '===,.IVi..,;======:..B#B#t.;==\n' +
                    'fill 0 0 $\n' +
                    'fill 0 u',
            'output': 'INPUT MISMATCH\n'
        ]
    ]

    void testData() {
        for (def entry in data) {
            // arrange
            def input           = entry['input']
            def expectedOutput  = entry['output']

            // act
            setup(input)
            app.run()

            // assert
            assert Arrays.equals(output.toByteArray(), expectedOutput.getBytes()): "Output != Expected "+output.toString()+"_"+expectedOutput.toString()
        }
    }

    private void setup(String inp) {
        def  bytes            = inp.getBytes()
        output                = new ByteArrayOutputStream()
        input                 = new ByteArrayInputStream(bytes)

        final IOHelper helper = new IOHelper(input, output)

        app = new ShopApp(helper)
    }
}
